(()=>{"use strict";var e={192:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(81),o=n.n(r),i=n(645),a=n.n(i),s=n(667),c=n.n(s),d=new URL(n(760),n.b),l=new URL(n(135),n.b),u=new URL(n(741),n.b),m=new URL(n(78),n.b),p=a()(o());p.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@200;400;700&display=swap);"]);var g=c()(d),v=c()(l),b=c()(u),f=c()(m);p.push([e.id,".blackout .text-message .close-button,.tab-button,.section .button{padding:0;border:0;background-color:rgba(0,0,0,0);font-family:inherit}.cars-list{padding:0;list-style:none}.blackout .text-message .close-button,.tab-button,.section .button{cursor:pointer;transition:.5s}.winners-list tbody td:nth-child(2),.cars-list .cars-list__item .car__image{-webkit-mask-image:url("+g+");-webkit-mask-size:100%;-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-image:url("+g+');mask-size:100%;mask-repeat:no-repeat;mask-position:center;background-color:#000}.winners-list th.descending,.winners-list th.ascending{padding-right:30px !important;background-position:bottom 50% right 5px;background-repeat:no-repeat;background-size:15px 15px}html{box-sizing:border-box;scroll-behavior:smooth}*,*::before,*::after{box-sizing:inherit}body{margin:0;background-color:#d9d9d9;font-family:"Lexend Deca",sans-serif;color:#212121}.section{position:absolute;width:100%;padding:20px;opacity:0}.section.section_visible{z-index:10;opacity:1}.section .button{display:inline-block;padding:5px;border-radius:1px;background-color:#faa357}.section .button:hover{background-color:#fff}.section .button[disabled=true]:hover{background-color:#faa357;cursor:default}.tabs{width:100%;height:5vh;background-color:#fff}.tab-button{width:100px;height:100%}.tab-button.tab-button_active{background-color:#d9d9d9}.section__header{display:grid;grid-template-columns:repeat(3, 1fr);justify-content:space-between;gap:15px 5px;width:300px}.form{display:flex;justify-content:space-between;width:100%}.form .form__color-input{border:0}.create-form,.update-form{grid-column:1/4}.cars-list .cars-list__item{position:relative;display:grid;grid-template-columns:repeat(2, max-content);gap:10px;margin-bottom:10px;border-bottom:#b0b0b0 2px dashed;background-image:url('+v+');background-repeat:no-repeat;background-position:right;background-size:contain}.cars-list .cars-list__item .car__image{width:100px;height:30px}.cars-list .cars-list__item .car__finish-point{position:absolute;bottom:0;right:15px;width:100px;height:30px}.cars-list .cars-list__item .control-buttons{display:grid;grid-template-columns:repeat(2, 1fr);gap:5px;grid-row:1/3}.cars-list .cars-list__item .control-buttons .button{border:rgba(0,0,0,0) 2px solid;background-color:#fff}.cars-list .cars-list__item .control-buttons .button:hover{border:#b0b0b0 2px solid}.cars-list .cars-list__item .control-buttons .button[disabled=true]:hover{border:rgba(0,0,0,0) 2px solid;cursor:default}.pagination{display:flex;gap:10px}.blackout{position:fixed;top:0;left:0;z-index:20;display:flex;justify-content:center;align-items:center;width:100vw;height:100vh;background-color:rgba(33,33,33,.5)}.blackout .text-message{position:relative;display:flex;justify-content:center;align-items:center;width:300px;height:200px;padding:10px;border-radius:5px;background-color:#d9d9d9;color:inherit;text-align:center}.blackout .text-message .close-button{position:absolute;top:0;right:0;width:20px;height:20px}.blackout .text-message .close-button::before{content:"X"}.winners-list{margin:16px 0;border:#b0b0b0 1px solid;border-collapse:collapse}.winners-list tr{padding:10px}.winners-list th{background-color:#b0b0b0}.winners-list th.ascending{background-image:url('+b+")}.winners-list th.descending{background-image:url("+f+")}.winners-list th.car-wins,.winners-list th.car-time{cursor:pointer}.winners-list th,.winners-list td{padding:10px}.winners-list tr:nth-child(even){background-color:#fff}",""]);const h=p},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);r&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],d=r.base?c[0]+r.base:c[0],l=i[d]||0,u="".concat(d," ").concat(l);i[d]=l+1;var m=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==m)t[m].references++,t[m].updater(p);else{var g=o(p,r);r.byIndex=s,t.splice(s,0,{identifier:u,updater:g,references:1})}a.push(u)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var c=r(e,o),d=0;d<i.length;d++){var l=n(i[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},741:(e,t,n)=>{e.exports=n.p+"4ceca2ce51d09099ca23.svg"},78:(e,t,n)=>{e.exports=n.p+"b837164b98be0c8727af.svg"},760:(e,t,n)=>{e.exports=n.p+"d891345da34205e4866c.svg"},135:(e,t,n)=>{e.exports=n.p+"a3e7744b58be9ab861ec.svg"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{var e=n(379),t=n.n(e),r=n(795),o=n.n(r),i=n(569),a=n.n(i),s=n(565),c=n.n(s),d=n(216),l=n.n(d),u=n(589),m=n.n(u),p=n(192),g={};g.styleTagTransform=m(),g.setAttributes=c(),g.insert=a().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=l(),t()(p.Z,g),p.Z&&p.Z.locals&&p.Z.locals;const v="garage",b="engine",f="winners",h="Content-Type",y="/",x='Race in progress. Wait for the end of the race and click "RESET"',w="ASC",_="GARAGE",S="WINNERS",A=["number","car-image","car-name","car-wins","car-time"],C=["â„–","Car","Name","Wins","Best time (sec)"],E="http://127.0.0.1:3000",k="#000000",T="",N=10,P="application/json";var L,O,R;!function(e){e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Three=3]="Three",e[e.Six=6]="Six"}(L||(L={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE"}(O||(O={})),function(e){e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.BadRequest=400]="BadRequest",e[e.NotFound=404]="NotFound",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError"}(R||(R={}));const q=(e,t,n,r)=>{const o=n?`/${n}`:y;return r?`${e}/${t}${o}${(e=>`?${Object.entries(e).map((e=>`${e[L.Zero]}=${e[L.One]}`)).join("&")}`)(r)}`:`${e}/${t}${o}`};var M=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const I=e=>t=>M(void 0,void 0,void 0,(function*(){const n=yield fetch(q(E,e,void 0,t));return{content:yield n.json(),totalAmount:n.headers.get("X-Total-Count")}})),$=e=>t=>M(void 0,void 0,void 0,(function*(){return(yield fetch(q(E,e,t))).json()})),j=e=>t=>M(void 0,void 0,void 0,(function*(){return(yield fetch(q(E,e),{method:O.POST,headers:{[h]:P},body:JSON.stringify(t)})).json()})),B=e=>t=>M(void 0,void 0,void 0,(function*(){return(yield fetch(q(E,e,t),{method:O.DELETE})).json()})),W=e=>(t,n)=>M(void 0,void 0,void 0,(function*(){return(yield fetch(q(E,e,t),{method:O.PUT,headers:{[h]:P},body:JSON.stringify(n)})).json()})),Z=e=>t=>M(void 0,void 0,void 0,(function*(){return(yield fetch(q(E,b,void 0,{id:t,status:e}),{method:O.PATCH})).json()})),D=e=>t=>M(void 0,void 0,void 0,(function*(){return!!(yield(yield fetch(q(E,e))).json()).find((e=>e.id===Number(t)))})),U={getCars:I(v),getWinners:I(f),getCarById:$(v),getWinnerById:$(f),createCar:j(v),createWinner:j(f),deleteCar:B(v),deleteWinner:B(f),updateCar:W(v),updateWinner:W(f),startEngine:Z("started"),stopEngine:Z("stopped"),switchEngineToDriveMode:e=>M(void 0,void 0,void 0,(function*(){const t=yield fetch(q(E,b,void 0,{id:e,status:"drive"}),{method:O.PATCH});return t.status===R.Ok?t.json():{success:!1}})),isCarExist:D(v),isWinnerExist:D(f)},F={garage:"GARAGE",winners:"WINNERS",create:"CREATE",update:"UPDATE",race:"RACE",reset:"RESET",generate:"GENERATE CARS",select:"SELECT",remove:"REMOVE",start:"START",stop:"STOP",previous:"PREVIOUS",next:"NEXT"},z={cars:[],winners:[],carsAmount:L.Zero,winnersAmount:L.Zero,garageCurrentPage:L.One,winnersCurrentPage:L.One,animate:{},sortKey:"id",sortOrder:w,isRaceStarted:!1},H=e=>{const{tag:t,classNames:n,innerText:r=T,listenerInfo:o,attributeInfo:i}=e,a=document.createElement(t);return a.classList.add(...n),a.textContent=r,void 0!==o&&a.addEventListener(o.eventName,o.callback),void 0!==i&&a.setAttribute(i[L.Zero],i[L.One]),a},G=e=>{const{children:t=[],id:n}=e,r=H(e);return r.append(...t),void 0!==n&&(r.id=n),r},X=e=>{e.target.closest(".blackout").remove()},K=e=>{const t=H({tag:"button",classNames:["close-button"],listenerInfo:{eventName:"click",callback:X}}),n=G({tag:"div",classNames:["text-message"],innerText:e,children:[t]}),r=G({tag:"div",classNames:["blackout"],children:[n]});document.body.append(r)},V=["Acura","Alfa Romeo","Audi","BMW","Bentley","Cadillac","Chevrolet","Dodge","Fiat","Ford","Honda","Hyundai","Jeep","Kia","Lincoln","Mazda","Mercedes-Benz","Nissan","Porsche","Subaru","Tesla","Toyota","Volkswagen","Volvo"],J=["X5","Cayenne","Polo","CX-5","Passat","Ulysse","Panamera","Zafira","Vito","Meteor","Escalade","Accent","Rio","Impreza"],Q=()=>{let e="#";for(let t=L.Zero;t<L.Six;t+=L.One)e+=`${Math.floor(16*Math.random()).toString(16)}`;return e},Y=()=>{return{name:(e=V,t=J,`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]}`),color:Q()};var e,t},ee=(e,t)=>`${e}(${t})`,te=e=>`Page #${e}`;var ne=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const re=e=>ne(void 0,void 0,void 0,(function*(){const t=e;t.querySelector(".start-button").setAttribute("disabled","true");const n=t.querySelector(".car__start-point"),r=t.querySelector(".car__finish-point"),o=yield U.startEngine(Number(t.id));t.querySelector(".stop-button").removeAttribute("disabled");const i=o.distance/o.velocity;var a,s;const c=((e,t,n)=>{const r=e;let o=L.Zero;const i={value:L.Zero},a=e=>{o||(o=e);const s=e-o,c=Math.floor(s*t/n);r.style.transform=`translateX(${Math.min(c,t)}px)`,c<t&&(i.value=window.requestAnimationFrame(a))};return i.value=window.requestAnimationFrame(a),i})(n,(a=n,s=r,Math.abs(a.getBoundingClientRect().x-s.getBoundingClientRect().x)),i);z.animate[t.id]=c;const{success:d}=yield U.switchEngineToDriveMode(Number(t.id));return d?{success:d,id:t.id,time:Number((i/1e3).toFixed(L.Three))}:(window.cancelAnimationFrame(c.value),{success:d,id:t.id})})),oe=e=>ne(void 0,void 0,void 0,(function*(){e.querySelector(".stop-button").setAttribute("disabled","true"),yield U.stopEngine(Number(e.id)),window.cancelAnimationFrame(z.animate[e.id].value),e.querySelector(".car__image").style.transform=T,e.querySelector(".start-button").removeAttribute("disabled")})),ie=(e,t)=>ne(void 0,void 0,void 0,(function*(){if(e.length===L.Zero)return{success:!1};const n=yield Promise.race(e);if(!n.success){const r=e.filter(((e,r)=>t[r]!==n.id));return ie(r,t.filter((e=>e!==n.id)))}return n})),ae=()=>{document.querySelector(".cars-list").innerHTML=T},se=e=>({name:e.text.value,color:e.color.value}),ce=(e,t,n)=>H({tag:"button",classNames:["button",`${e}-button`],innerText:F[e],listenerInfo:t,attributeInfo:n}),de=({name:e,color:t,id:n})=>{const r=H({tag:"div",classNames:["car__image","car__start-point"]});return r.style.backgroundColor=t,G({tag:"li",classNames:["cars-list__item","car"],children:[G({tag:"div",classNames:["control-buttons"],children:[ce("select"),ce("remove"),ce("start"),ce("stop",void 0,["disabled","true"])]}),H({tag:"div",classNames:["car__name"],innerText:e}),r,H({tag:"div",classNames:["car__finish-point"]})],id:`${n}`})},le=(e,t,n)=>{const r=e.querySelector(".previous-button"),o=e.querySelector(".next-button");[r,o].forEach((e=>e.removeAttribute("disabled"))),t<=L.One&&r.setAttribute("disabled","true"),t>=n&&o.setAttribute("disabled","true")};const ue=()=>function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){const e=yield U.getCars({_page:z.garageCurrentPage,_limit:7});[z.cars,z.carsAmount]=[e.content,Number(e.totalAmount)];const t=document.getElementById("garage");document.querySelector(".garage__title").textContent=ee(_,e.totalAmount),document.querySelector(".garage__page-number").textContent=te(z.garageCurrentPage),document.querySelector(".cars-list").append(...e.content.map(de)),le(t.querySelector(".pagination"),z.garageCurrentPage,Math.ceil(z.carsAmount/7))})),me=(e,t,n,r)=>{const o=document.createElement("tr");return o.append(...t.map(((t,o)=>{const i=document.createElement(e);return i.textContent=t,o===L.One&&(i.style.backgroundColor=n),void 0!==r&&i.classList.add(r[o]),i}))),o},pe=e=>{const t=document.createElement("tbody");return t.append(...e.map(((e,t)=>me("td",[`${t+L.One+(z.winnersCurrentPage-L.One)*N}`,"",`${e.name}`,`${e.wins}`,`${e.time}`],e.color)))),t};var ge=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const ve=()=>ge(void 0,void 0,void 0,(function*(){const e=yield U.getWinners({_page:z.winnersCurrentPage,_limit:N,_sort:z.sortKey,_order:z.sortOrder}),t=yield Promise.all(e.content.map((e=>ge(void 0,void 0,void 0,(function*(){return Object.assign(e,yield U.getCarById(String(e.id)))})))));[z.winners,z.winnersAmount]=[e.content,Number(e.totalAmount)];const n=document.getElementById("winners");document.querySelector(".winners__title").textContent=ee(S,e.totalAmount),document.querySelector(".winners__page-number").textContent=te(z.winnersCurrentPage);const r=document.querySelector(".winners-list");r.lastChild.remove(),r.append(pe(t)),le(n.querySelector(".pagination"),z.winnersCurrentPage,Math.ceil(z.winnersAmount/N))}));var be=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const fe=e=>be(void 0,void 0,void 0,(function*(){if(e.preventDefault(),z.isRaceStarted)return void K(x);const t=e.target;t.text.value.trim()!==T?(yield U.createCar(se(t)),t.text.value=T,t.color.value=k,ae(),yield ue()):K("Please, enter a name")})),he=e=>be(void 0,void 0,void 0,(function*(){if(e.preventDefault(),z.isRaceStarted)return void K(x);const t=e.target;t.hasAttribute("data-current-id")?(yield U.updateCar(t.dataset.currentId,se(t)),t.text.value=T,t.color.value=k,t.removeAttribute("data-current-id"),ae(),yield ue(),yield ve()):K("Please, select a car")})),ye=e=>be(void 0,void 0,void 0,(function*(){const t=e.target;t.classList.contains("select-button")&&(yield(e=>be(void 0,void 0,void 0,(function*(){if(z.isRaceStarted)return void K(x);const t=document.querySelector(".update-form"),n=e.target.closest(".car").id,r=yield U.getCarById(n);t.dataset.currentId=n,t.text.value=r.name,t.color.value=r.color})))(e)),t.classList.contains("remove-button")&&(yield(e=>be(void 0,void 0,void 0,(function*(){if(z.isRaceStarted)return void K(x);const t=e.target.closest(".car").id;yield U.deleteCar(t),(yield U.isWinnerExist(t))&&(yield U.deleteWinner(t)),ae(),yield ue(),yield ve()})))(e)),t.classList.contains("start-button")&&(yield(e=>be(void 0,void 0,void 0,(function*(){const t=e.target.closest(".car");yield re(t)})))(e)),t.classList.contains("stop-button")&&(yield(e=>be(void 0,void 0,void 0,(function*(){z.isRaceStarted?K(x):yield oe(e.target.closest(".car"))})))(e))})),xe=()=>be(void 0,void 0,void 0,(function*(){z.isRaceStarted?K(x):(yield Promise.all(new Array(100).fill(Y).map((e=>U.createCar(e())))),ae(),yield ue())})),we=()=>be(void 0,void 0,void 0,(function*(){document.querySelector(".race-button").setAttribute("disabled","true"),z.isRaceStarted=!0;const e=Array.from(document.querySelectorAll(".car")),t=e.map(re),{success:n,id:r,time:o}=yield ie(t,e.map((e=>e.id)));if(n){if(yield U.isWinnerExist(r)){const{wins:e,time:t}=yield U.getWinnerById(r),n=e+L.One,i=t<o?t:o;yield U.updateWinner(r,{wins:n,time:i})}else yield U.createWinner({id:Number(r),wins:L.One,time:o});document.querySelector(".reset-button").removeAttribute("disabled"),K(`The winner is ${(yield U.getCarById(r)).name} (${o}s)`),yield ve()}else document.querySelector(".reset-button").removeAttribute("disabled")})),_e=()=>be(void 0,void 0,void 0,(function*(){document.querySelector(".reset-button").setAttribute("disabled","true"),yield Promise.allSettled(Array.from(document.querySelectorAll(".car")).map(oe)),z.isRaceStarted=!1,document.querySelector(".race-button").removeAttribute("disabled")})),Se=e=>be(void 0,void 0,void 0,(function*(){const t=e.target;if(!t.classList.contains("car-wins")&&!t.classList.contains("car-time"))return;const n=t.dataset.order===w?"DESC":w;t.dataset.order=n,document.querySelectorAll("th").forEach((e=>e.classList.remove("ascending","descending"))),t.classList.add(n===w?"ascending":"descending"),t.classList.contains("car-wins")?(z.sortKey="wins",z.sortOrder=n):t.classList.contains("car-time")&&(z.sortKey="time",z.sortOrder=n),yield ve()})),Ae=e=>be(void 0,void 0,void 0,(function*(){const t=e.target;t instanceof HTMLButtonElement&&(z.isRaceStarted?K(x):(t.classList.contains("next-button")&&(z.garageCurrentPage+=L.One),t.classList.contains("previous-button")&&(z.garageCurrentPage-=L.One),ae(),yield ue(),le(t.closest(".pagination"),z.garageCurrentPage,Math.ceil(z.carsAmount/7))))})),Ce=e=>be(void 0,void 0,void 0,(function*(){const t=e.target;t instanceof HTMLButtonElement&&(t.classList.contains("next-button")&&(z.winnersCurrentPage+=L.One),t.classList.contains("previous-button")&&(z.winnersCurrentPage-=L.One),yield ve(),le(t.closest(".pagination"),z.winnersCurrentPage,Math.ceil(z.winnersAmount/N)))})),Ee=(e,t,n,r=T)=>{const o=document.createElement("input");return o.type=e,o.name=n,o.classList.add(t),"text"===e&&(o.placeholder=r,o.setAttribute("autocomplete","off")),o},ke=(e,t)=>G({tag:"form",classNames:["form",`${e}-form`],children:[Ee("text","form__text-input","text","create"===e?"Enter car name":"Select car to update"),Ee("color","form__color-input","color"),ce(e)],listenerInfo:t}),Te=(e,t,n)=>{const r=ce("previous");t<=L.One&&r.setAttribute("disabled","true");const o=ce("next");return t>=n&&o.setAttribute("disabled","true"),G({tag:"div",classNames:["pagination"],children:[r,o],listenerInfo:{eventName:"click",callback:e}})},Ne=e=>{if(!e.target.classList.contains("tab-button"))return;const t=e.target;document.querySelectorAll(".tab-button").forEach((e=>e.classList.remove("tab-button_active"))),t.classList.add("tab-button_active"),document.querySelectorAll("section").forEach((e=>{e.classList.remove("section_visible")})),document.getElementById(t.textContent.toLowerCase()).classList.add("section_visible")},Pe=()=>{const e=document.createElement("thead");return e.classList.add("table__head","head"),e.addEventListener("click",Se),e.append(me("th",C,T,A)),e},Le=e=>G({tag:"table",classNames:["winners-list","table"],children:[Pe(),pe(e)]});var Oe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};(function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))})(void 0,void 0,void 0,(function*(){const e=yield U.getCars({_page:L.One,_limit:7}),t=yield U.getWinners({_page:L.One,_limit:N});return[z.cars,z.carsAmount]=[e.content,Number(e.totalAmount)],[z.winners,z.winnersAmount]=[t.content,Number(t.totalAmount)],[e,t]})).then((([e,t])=>Oe(void 0,void 0,void 0,(function*(){const n=yield Promise.all(t.content.map((e=>Oe(void 0,void 0,void 0,(function*(){return Object.assign(e,yield U.getCarById(String(e.id)))}))))),r=document.createElement("main");var o,i,a;r.append((o=e,i=z.garageCurrentPage,a=Math.ceil(z.carsAmount/7),G({tag:"section",id:"garage",classNames:["section","section_visible"],children:[G({tag:"div",classNames:["section__header"],children:[ke("create",{eventName:"submit",callback:fe}),ke("update",{eventName:"submit",callback:he}),ce("race",{eventName:"click",callback:we}),ce("reset",{eventName:"click",callback:_e},["disabled","true"]),ce("generate",{eventName:"click",callback:xe})]}),H({tag:"h2",classNames:["section__title","garage__title"],innerText:ee(_,o.totalAmount)}),H({tag:"div",classNames:["garage__page-number"],innerText:te(i)}),G({tag:"ul",classNames:["cars-list"],children:o.content.map((e=>de(e)))}),Te(Ae,i,a)],listenerInfo:{eventName:"click",callback:ye}})),((e,t,n,r)=>G({tag:"section",id:"winners",classNames:["section"],children:[H({tag:"h2",classNames:["section__title","winners__title"],innerText:ee(S,t)}),H({tag:"div",classNames:["winners__page-number"],innerText:te(n)}),Le(e),Te(Ce,n,r)]}))(n,t.totalAmount,z.garageCurrentPage,Math.ceil(z.winnersAmount/N)));const s=G({tag:"header",classNames:["tabs"],children:[F.garage,F.winners].map(((e,t)=>{const n=H({tag:"button",classNames:["tab-button"],innerText:e});return t===L.Zero&&n.classList.add("tab-button_active"),n})),listenerInfo:{eventName:"click",callback:Ne}});document.body.append(s,r)}))))})()})();