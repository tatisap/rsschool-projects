(()=>{"use strict";var e={192:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(81),o=n.n(r),i=n(645),a=n.n(i),s=n(667),c=n.n(s),d=new URL(n(760),n.b),l=new URL(n(135),n.b),u=new URL(n(741),n.b),m=new URL(n(78),n.b),p=a()(o());p.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@200;400;700&display=swap);"]);var g=c()(d),v=c()(l),b=c()(u),f=c()(m);p.push([e.id,".blackout .text-message .close-button,.tab-button,.section .button{padding:0;border:0;background-color:rgba(0,0,0,0);font-family:inherit}.cars-list{padding:0;list-style:none}.blackout .text-message .close-button,.tab-button,.section .button{cursor:pointer;transition:.5s}.winners-list tbody td:nth-child(2),.cars-list .cars-list__item .car__image{-webkit-mask-image:url("+g+");-webkit-mask-size:100%;-webkit-mask-repeat:no-repeat;-webkit-mask-position:center;mask-image:url("+g+');mask-size:100%;mask-repeat:no-repeat;mask-position:center;background-color:#000}.winners-list th.descending,.winners-list th.ascending{padding-right:30px !important;background-position:bottom 50% right 5px;background-repeat:no-repeat;background-size:15px 15px}html{box-sizing:border-box;scroll-behavior:smooth}*,*::before,*::after{box-sizing:inherit}body{margin:0;background-color:#d9d9d9;font-family:"Lexend Deca",sans-serif;color:#212121}.section{position:absolute;width:100%;padding:20px;opacity:0}.section.section_visible{z-index:10;opacity:1}.section .button{display:inline-block;padding:5px;border-radius:1px;background-color:#faa357}.section .button:hover{background-color:#fff}.section .button[disabled=true]:hover{background-color:#faa357;cursor:default}.tabs{width:100%;height:5vh;background-color:#fff}.tab-button{width:100px;height:100%}.tab-button.tab-button_active{background-color:#d9d9d9}.section__header{display:grid;grid-template-columns:repeat(3, 1fr);justify-content:space-between;gap:15px 5px;width:300px}.form{display:flex;justify-content:space-between;width:100%}.form .form__color-input{border:0}.create-form,.update-form{grid-column:1/4}.cars-list .cars-list__item{position:relative;display:grid;grid-template-columns:repeat(2, max-content);gap:10px;margin-bottom:10px;border-bottom:#b0b0b0 2px dashed;background-image:url('+v+');background-repeat:no-repeat;background-position:right;background-size:contain}.cars-list .cars-list__item .car__image{width:100px;height:30px}.cars-list .cars-list__item .car__finish-point{position:absolute;bottom:0;right:15px;width:100px;height:30px}.cars-list .cars-list__item .control-buttons{display:grid;grid-template-columns:repeat(2, 1fr);gap:5px;grid-row:1/3}.cars-list .cars-list__item .control-buttons .button{border:rgba(0,0,0,0) 2px solid;background-color:#fff}.cars-list .cars-list__item .control-buttons .button:hover{border:#b0b0b0 2px solid}.cars-list .cars-list__item .control-buttons .button[disabled=true]:hover{border:rgba(0,0,0,0) 2px solid;cursor:default}.pagination{display:flex;gap:10px}.blackout{position:fixed;top:0;left:0;z-index:20;display:flex;justify-content:center;align-items:center;width:100vw;height:100vh;background-color:rgba(33,33,33,.5)}.blackout .text-message{position:relative;display:flex;justify-content:center;align-items:center;width:300px;height:200px;padding:10px;border-radius:5px;background-color:#d9d9d9;color:inherit;text-align:center}.blackout .text-message .close-button{position:absolute;top:0;right:0;width:20px;height:20px}.blackout .text-message .close-button::before{content:"X"}.winners-list{margin:16px 0;border:#b0b0b0 1px solid;border-collapse:collapse}.winners-list tr{padding:10px}.winners-list th{background-color:#b0b0b0}.winners-list th.ascending{background-image:url('+b+")}.winners-list th.descending{background-image:url("+f+")}.winners-list th.car-wins,.winners-list th.car-time{cursor:pointer}.winners-list th,.winners-list td{padding:10px}.winners-list tr:nth-child(even){background-color:#fff}",""]);const h=p},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var d=0;d<e.length;d++){var l=[].concat(e[d]);r&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],d=r.base?c[0]+r.base:c[0],l=i[d]||0,u="".concat(d," ").concat(l);i[d]=l+1;var m=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==m)t[m].references++,t[m].updater(p);else{var g=o(p,r);r.byIndex=s,t.splice(s,0,{identifier:u,updater:g,references:1})}a.push(u)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var c=r(e,o),d=0;d<i.length;d++){var l=n(i[d]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},741:(e,t,n)=>{e.exports=n.p+"4ceca2ce51d09099ca23.svg"},78:(e,t,n)=>{e.exports=n.p+"b837164b98be0c8727af.svg"},760:(e,t,n)=>{e.exports=n.p+"d891345da34205e4866c.svg"},135:(e,t,n)=>{e.exports=n.p+"a3e7744b58be9ab861ec.svg"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{var e=n(379),t=n.n(e),r=n(795),o=n.n(r),i=n(569),a=n.n(i),s=n(565),c=n.n(s),d=n(216),l=n.n(d),u=n(589),m=n.n(u),p=n(192),g={};g.styleTagTransform=m(),g.setAttributes=c(),g.insert=a().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=l(),t()(p.Z,g),p.Z&&p.Z.locals&&p.Z.locals;const v="garage",b="engine",f="winners",h="Content-Type",y="/",x='Race in progress. Wait for the end of the race and click "RESET"',w="ASC",_="GARAGE",S="WINNERS",A=["number","car-image","car-name","car-wins","car-time"],C=["â„–","Car","Name","Wins","Best time (sec)"],E="http://127.0.0.1:3000",k="#000000",T="",N=10;var P,L,O;!function(e){e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Three=3]="Three",e[e.Six=6]="Six"}(P||(P={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.DELETE="DELETE"}(L||(L={})),function(e){e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.BadRequest=400]="BadRequest",e[e.NotFound=404]="NotFound",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError"}(O||(O={}));const R=(e,t,n,r)=>{const o=n?`/${n}`:y;return r?`${e}/${t}${o}${(e=>`?${Object.entries(e).map((e=>`${e[P.Zero]}=${e[P.One]}`)).join("&")}`)(r)}`:`${e}/${t}${o}`};var q=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const M=e=>t=>q(void 0,void 0,void 0,(function*(){const n=yield fetch(R(E,e,void 0,t));return{content:yield n.json(),totalAmount:n.headers.get("X-Total-Count")}})),I=e=>t=>q(void 0,void 0,void 0,(function*(){return(yield fetch(R(E,e,t))).json()})),$=e=>t=>q(void 0,void 0,void 0,(function*(){return(yield fetch(R(E,e),{method:L.POST,headers:{[h]:"application/json"},body:JSON.stringify(t)})).json()})),j=e=>t=>q(void 0,void 0,void 0,(function*(){return(yield fetch(R(E,e,t),{method:L.DELETE})).json()})),B=e=>(t,n)=>q(void 0,void 0,void 0,(function*(){return(yield fetch(R(E,e,t),{method:L.PUT,headers:{[h]:"application/json"},body:JSON.stringify(n)})).json()})),W=e=>t=>q(void 0,void 0,void 0,(function*(){return(yield fetch(R(E,b,void 0,{id:t,status:e}),{method:L.PATCH})).json()})),Z=e=>t=>q(void 0,void 0,void 0,(function*(){return!!(yield(yield fetch(R(E,e))).json()).find((e=>e.id===Number(t)))})),D={getCars:M(v),getWinners:M(f),getCarById:I(v),getWinnerById:I(f),createCar:$(v),createWinner:$(f),deleteCar:j(v),deleteWinner:j(f),updateCar:B(v),updateWinner:B(f),startEngine:W("started"),stopEngine:W("stopped"),switchEngineToDriveMode:e=>q(void 0,void 0,void 0,(function*(){const t=yield fetch(R(E,b,void 0,{id:e,status:"drive"}),{method:L.PATCH});return t.status===O.Ok?t.json():{success:!1}})),isCarExist:Z(v),isWinnerExist:Z(f)},U={garage:"GARAGE",winners:"WINNERS",create:"CREATE",update:"UPDATE",race:"RACE",reset:"RESET",generate:"GENERATE CARS",select:"SELECT",remove:"REMOVE",start:"START",stop:"STOP",previous:"PREVIOUS",next:"NEXT"},F={cars:[],winners:[],carsAmount:P.Zero,winnersAmount:P.Zero,garageCurrentPage:P.One,winnersCurrentPage:P.One,animate:{},sortKey:"id",sortOrder:"ASC",isRaceStarted:!1},z=e=>{const{tag:t,classNames:n,innerText:r=T,listenerInfo:o,attributeInfo:i}=e,a=document.createElement(t);return a.classList.add(...n),a.textContent=r,void 0!==o&&a.addEventListener(o.eventName,o.callback),void 0!==i&&a.setAttribute(i[P.Zero],i[P.One]),a},H=e=>{const{children:t=[],id:n}=e,r=z(e);return r.append(...t),void 0!==n&&(r.id=n),r},G=e=>{e.target.closest(".blackout").remove()},X=e=>{const t=z({tag:"button",classNames:["close-button"],listenerInfo:{eventName:"click",callback:G}}),n=H({tag:"div",classNames:["text-message"],innerText:e,children:[t]}),r=H({tag:"div",classNames:["blackout"],children:[n]});document.body.append(r)},K=["Acura","Alfa Romeo","Audi","BMW","Bentley","Cadillac","Chevrolet","Dodge","Fiat","Ford","Honda","Hyundai","Jeep","Kia","Lincoln","Mazda","Mercedes-Benz","Nissan","Porsche","Subaru","Tesla","Toyota","Volkswagen","Volvo"],V=["X5","Cayenne","Polo","CX-5","Passat","Ulysse","Panamera","Zafira","Vito","Meteor","Escalade","Accent","Rio","Impreza"],J=()=>{let e="#";for(let t=P.Zero;t<P.Six;t+=P.One)e+=`${Math.floor(16*Math.random()).toString(16)}`;return e},Q=()=>{return{name:(e=K,t=V,`${e[Math.floor(Math.random()*e.length)]} ${t[Math.floor(Math.random()*t.length)]}`),color:J()};var e,t},Y=(e,t)=>`${e}(${t})`,ee=e=>`Page #${e}`;var te=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const ne=e=>te(void 0,void 0,void 0,(function*(){const t=e;t.querySelector(".start-button").setAttribute("disabled","true");const n=t.querySelector(".car__start-point"),r=t.querySelector(".car__finish-point"),o=yield D.startEngine(Number(t.id));t.querySelector(".stop-button").removeAttribute("disabled");const i=o.distance/o.velocity;var a,s;const c=((e,t,n)=>{const r=e;let o=P.Zero;const i={value:P.Zero},a=e=>{o||(o=e);const s=e-o,c=Math.floor(s*t/n);r.style.transform=`translateX(${Math.min(c,t)}px)`,c<t&&(i.value=window.requestAnimationFrame(a))};return i.value=window.requestAnimationFrame(a),i})(n,(a=n,s=r,Math.abs(a.getBoundingClientRect().x-s.getBoundingClientRect().x)),i);F.animate[t.id]=c;const{success:d}=yield D.switchEngineToDriveMode(Number(t.id));return d?{success:d,id:t.id,time:Number((i/1e3).toFixed(P.Three))}:(window.cancelAnimationFrame(c.value),{success:d,id:t.id})})),re=e=>te(void 0,void 0,void 0,(function*(){e.querySelector(".stop-button").setAttribute("disabled","true"),yield D.stopEngine(Number(e.id)),window.cancelAnimationFrame(F.animate[e.id].value),e.querySelector(".car__image").style.transform=T,e.querySelector(".start-button").removeAttribute("disabled")})),oe=(e,t)=>te(void 0,void 0,void 0,(function*(){if(e.length===P.Zero)return{success:!1};const n=yield Promise.race(e);if(!n.success){const r=e.filter(((e,r)=>t[r]!==n.id));return oe(r,t.filter((e=>e!==n.id)))}return n})),ie=()=>{document.querySelector(".cars-list").innerHTML=T},ae=e=>({name:e.text.value,color:e.color.value}),se=(e,t,n)=>z({tag:"button",classNames:["button",`${e}-button`],innerText:U[e],listenerInfo:t,attributeInfo:n}),ce=({name:e,color:t,id:n})=>{const r=z({tag:"div",classNames:["car__image","car__start-point"]});return r.style.backgroundColor=t,H({tag:"li",classNames:["cars-list__item","car"],children:[H({tag:"div",classNames:["control-buttons"],children:[se("select"),se("remove"),se("start"),se("stop",void 0,["disabled","true"])]}),z({tag:"div",classNames:["car__name"],innerText:e}),r,z({tag:"div",classNames:["car__finish-point"]})],id:`${n}`})},de=(e,t,n)=>{const r=e.querySelector(".previous-button"),o=e.querySelector(".next-button");[r,o].forEach((e=>e.removeAttribute("disabled"))),t<=P.One&&r.setAttribute("disabled","true"),t>=n&&o.setAttribute("disabled","true")};const le=()=>function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){const e=yield D.getCars({_page:F.garageCurrentPage,_limit:7});[F.cars,F.carsAmount]=[e.content,Number(e.totalAmount)];const t=document.getElementById("garage");document.querySelector(".garage__title").textContent=Y(_,e.totalAmount),document.querySelector(".garage__page-number").textContent=ee(F.garageCurrentPage),document.querySelector(".cars-list").append(...e.content.map(ce)),de(t.querySelector(".pagination"),F.garageCurrentPage,Math.ceil(F.carsAmount/7))})),ue=(e,t,n,r)=>{const o=document.createElement("tr");return o.append(...t.map(((t,o)=>{const i=document.createElement(e);return i.textContent=t,o===P.One&&(i.style.backgroundColor=n),void 0!==r&&i.classList.add(r[o]),i}))),o},me=e=>{const t=document.createElement("tbody");return t.append(...e.map(((e,t)=>ue("td",[`${t+P.One+(F.winnersCurrentPage-P.One)*N}`,"",`${e.name}`,`${e.wins}`,`${e.time}`],e.color)))),t};var pe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const ge=()=>pe(void 0,void 0,void 0,(function*(){const e=yield D.getWinners({_page:F.winnersCurrentPage,_limit:N,_sort:F.sortKey,_order:F.sortOrder}),t=yield Promise.all(e.content.map((e=>pe(void 0,void 0,void 0,(function*(){return Object.assign(e,yield D.getCarById(String(e.id)))})))));[F.winners,F.winnersAmount]=[e.content,Number(e.totalAmount)];const n=document.getElementById("winners");document.querySelector(".winners__title").textContent=Y(S,e.totalAmount),document.querySelector(".winners__page-number").textContent=ee(F.winnersCurrentPage);const r=document.querySelector(".winners-list");r.lastChild.remove(),r.append(me(t)),de(n.querySelector(".pagination"),F.winnersCurrentPage,Math.ceil(F.winnersAmount/N))}));var ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const be=e=>ve(void 0,void 0,void 0,(function*(){if(e.preventDefault(),F.isRaceStarted)return void X(x);const t=e.target;t.text.value.trim()!==T?(yield D.createCar(ae(t)),t.text.value=T,t.color.value=k,ie(),yield le()):X("Please, enter a name")})),fe=e=>ve(void 0,void 0,void 0,(function*(){if(e.preventDefault(),F.isRaceStarted)return void X(x);const t=e.target;t.hasAttribute("data-current-id")?(yield D.updateCar(t.dataset.currentId,ae(t)),t.text.value=T,t.color.value=k,t.removeAttribute("data-current-id"),ie(),yield le(),yield ge()):X("Please, select a car")})),he=e=>ve(void 0,void 0,void 0,(function*(){const t=e.target;t.classList.contains("select-button")&&(yield(e=>ve(void 0,void 0,void 0,(function*(){if(F.isRaceStarted)return void X(x);const t=document.querySelector(".update-form"),n=e.target.closest(".car").id,r=yield D.getCarById(n);t.dataset.currentId=n,t.text.value=r.name,t.color.value=r.color})))(e)),t.classList.contains("remove-button")&&(yield(e=>ve(void 0,void 0,void 0,(function*(){if(F.isRaceStarted)return void X(x);const t=e.target.closest(".car").id;yield D.deleteCar(t),(yield D.isWinnerExist(t))&&(yield D.deleteWinner(t)),ie(),yield le(),yield ge()})))(e)),t.classList.contains("start-button")&&(yield(e=>ve(void 0,void 0,void 0,(function*(){const t=e.target.closest(".car");yield ne(t)})))(e)),t.classList.contains("stop-button")&&(yield(e=>ve(void 0,void 0,void 0,(function*(){F.isRaceStarted?X(x):yield re(e.target.closest(".car"))})))(e))})),ye=()=>ve(void 0,void 0,void 0,(function*(){F.isRaceStarted?X(x):(yield Promise.all(new Array(100).fill(Q).map((e=>D.createCar(e())))),ie(),yield le())})),xe=()=>ve(void 0,void 0,void 0,(function*(){document.querySelector(".race-button").setAttribute("disabled","true"),F.isRaceStarted=!0;const e=Array.from(document.querySelectorAll(".car")),t=e.map(ne),{success:n,id:r,time:o}=yield oe(t,e.map((e=>e.id)));if(n){if(yield D.isWinnerExist(r)){const{wins:e,time:t}=yield D.getWinnerById(r),n=e+P.One,i=t<o?t:o;yield D.updateWinner(r,{wins:n,time:i})}else yield D.createWinner({id:Number(r),wins:P.One,time:o});document.querySelector(".reset-button").removeAttribute("disabled"),X(`The winner is ${(yield D.getCarById(r)).name} (${o}s)`),yield ge()}else document.querySelector(".reset-button").removeAttribute("disabled")})),we=()=>ve(void 0,void 0,void 0,(function*(){document.querySelector(".reset-button").setAttribute("disabled","true"),F.isRaceStarted=!1,yield Promise.allSettled(Array.from(document.querySelectorAll(".car")).map(re)),document.querySelector(".race-button").removeAttribute("disabled")})),_e=e=>ve(void 0,void 0,void 0,(function*(){const t=e.target;if(!t.classList.contains("car-wins")&&!t.classList.contains("car-time"))return;const n=t.dataset.order===w?"DESC":w;t.dataset.order=n,document.querySelectorAll("th").forEach((e=>e.classList.remove("ascending","descending"))),t.classList.add(n===w?"ascending":"descending"),t.classList.contains("car-wins")?(F.sortKey="wins",F.sortOrder=n):t.classList.contains("car-time")&&(F.sortKey="time",F.sortOrder=n),yield ge()})),Se=e=>ve(void 0,void 0,void 0,(function*(){const t=e.target;t instanceof HTMLButtonElement&&(F.isRaceStarted?X(x):(t.classList.contains("next-button")&&(F.garageCurrentPage+=P.One),t.classList.contains("previous-button")&&(F.garageCurrentPage-=P.One),ie(),yield le(),de(t.closest(".pagination"),F.garageCurrentPage,Math.ceil(F.carsAmount/7))))})),Ae=e=>ve(void 0,void 0,void 0,(function*(){const t=e.target;t instanceof HTMLButtonElement&&(t.classList.contains("next-button")&&(F.winnersCurrentPage+=P.One),t.classList.contains("previous-button")&&(F.winnersCurrentPage-=P.One),yield ge(),de(t.closest(".pagination"),F.winnersCurrentPage,Math.ceil(F.winnersAmount/N)))})),Ce=(e,t,n,r=T)=>{const o=document.createElement("input");return o.type=e,o.name=n,o.classList.add(t),"text"===e&&(o.placeholder=r,o.setAttribute("autocomplete","off")),o},Ee=(e,t)=>H({tag:"form",classNames:["form",`${e}-form`],children:[Ce("text","form__text-input","text","create"===e?"Enter car name":"Select car to update"),Ce("color","form__color-input","color"),se(e)],listenerInfo:t}),ke=(e,t,n)=>{const r=se("previous");t===P.One&&r.setAttribute("disabled","true");const o=se("next");return t===n&&o.setAttribute("disabled","true"),H({tag:"div",classNames:["pagination"],children:[r,o],listenerInfo:{eventName:"click",callback:e}})},Te=e=>{if(!e.target.classList.contains("tab-button"))return;const t=e.target;document.querySelectorAll(".tab-button").forEach((e=>e.classList.remove("tab-button_active"))),t.classList.add("tab-button_active"),document.querySelectorAll("section").forEach((e=>{e.classList.remove("section_visible")})),document.getElementById(t.textContent.toLowerCase()).classList.add("section_visible")},Ne=()=>{const e=document.createElement("thead");return e.classList.add("table__head","head"),e.addEventListener("click",_e),e.append(ue("th",C,T,A)),e},Pe=e=>H({tag:"table",classNames:["winners-list","table"],children:[Ne(),me(e)]});var Le=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};(function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))})(void 0,void 0,void 0,(function*(){const e=yield D.getCars({_page:P.One,_limit:7}),t=yield D.getWinners({_page:P.One,_limit:N});return[F.cars,F.carsAmount]=[e.content,Number(e.totalAmount)],[F.winners,F.winnersAmount]=[t.content,Number(t.totalAmount)],[e,t]})).then((([e,t])=>Le(void 0,void 0,void 0,(function*(){const n=yield Promise.all(t.content.map((e=>Le(void 0,void 0,void 0,(function*(){return Object.assign(e,yield D.getCarById(String(e.id)))}))))),r=document.createElement("main");var o,i,a;r.append((o=e,i=F.garageCurrentPage,a=Math.ceil(F.carsAmount/7),H({tag:"section",id:"garage",classNames:["section","section_visible"],children:[H({tag:"div",classNames:["section__header"],children:[Ee("create",{eventName:"submit",callback:be}),Ee("update",{eventName:"submit",callback:fe}),se("race",{eventName:"click",callback:xe}),se("reset",{eventName:"click",callback:we},["disabled","true"]),se("generate",{eventName:"click",callback:ye})]}),z({tag:"h2",classNames:["section__title","garage__title"],innerText:Y(_,o.totalAmount)}),z({tag:"div",classNames:["garage__page-number"],innerText:ee(i)}),H({tag:"ul",classNames:["cars-list"],children:o.content.map((e=>ce(e)))}),ke(Se,i,a)],listenerInfo:{eventName:"click",callback:he}})),((e,t,n,r)=>H({tag:"section",id:"winners",classNames:["section"],children:[z({tag:"h2",classNames:["section__title","winners__title"],innerText:Y(S,t)}),z({tag:"div",classNames:["winners__page-number"],innerText:ee(n)}),Pe(e),ke(Ae,n,r)]}))(n,t.totalAmount,F.garageCurrentPage,Math.ceil(F.winnersAmount/N)));const s=H({tag:"header",classNames:["tabs"],children:[U.garage,U.winners].map(((e,t)=>{const n=z({tag:"button",classNames:["tab-button"],innerText:e});return t===P.Zero&&n.classList.add("tab-button_active"),n})),listenerInfo:{eventName:"click",callback:Te}});document.body.append(s,r)}))))})()})();